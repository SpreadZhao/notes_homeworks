---
num: "109"
title: Convert Sorted List to Binary Search Tree
link: https://leetcode.cn/problems/convert-sorted-list-to-binary-search-tree/description/
tags:
  - leetcode/difficulty/medium
---
> [!error]- Deprecated
> 
> è¿™é“é¢˜è¦æ±‚æˆ‘ä»¬å°†ä¸€ä¸ªæ’å¥½åºçš„é“¾è¡¨è½¬æ¢ä¸ºäºŒå‰æœç´¢æ ‘ï¼Œä¸ºäº†è¾¾æˆå¹³å‡æœç´¢æ¬¡æ•°æœ€å°çš„ç›®çš„ï¼ŒäºŒå‰æœç´¢æ ‘è¦æ±‚æˆ‘ä»¬å°½å¯èƒ½å°†æ¯ä¸€å±‚çš„ç»“ç‚¹å¡«å……å¾—æœ€ä¸ºå……å®ï¼Œå³**å®ƒçš„ä»»ä½•ä¸¤æ£µå­æ ‘å±‚æ•°å·®éƒ½ä¸è¶…è¿‡1**ï¼Œæ‹¥æœ‰$2^n-1$ä¸ªç»“ç‚¹çš„äºŒå‰æœç´¢æ ‘æœç´¢åˆ°ç›®æ ‡ç»“ç‚¹æœ€å¤šåªéœ€è¦æœç´¢næ¬¡
> 
> å‚è€ƒSolutionï¼Œè¿ç”¨**åˆ†æ²»**çš„æ€æƒ³ï¼Œæˆ‘ä»¬éœ€è¦äº”æ­¥æ¥å®ç°è¿™ä¸ªç®—æ³•ï¼š
> 
> 1. å°†æ•°ç»„çš„ä¸­é—´å…ƒç´ è®¾ç½®ä¸ºæ ¹ç»“ç‚¹
> 2. é€’å½’åœ°å¯¹å·¦åŠéƒ¨åˆ†å’Œå³åŠéƒ¨åˆ†åšåŒæ ·çš„äº‹
> 3. è·å–å·¦åŠéƒ¨åˆ†çš„ä¸­é—´å…ƒç´ ï¼Œå¹¶ä½¿å…¶æˆä¸ºæ­¥éª¤ä¸€ä¸­åˆ›å»ºçš„æ ¹çš„å·¦å­©å­
> 4. è·å–å³åŠéƒ¨åˆ†çš„ä¸­é—´å…ƒç´ ï¼Œå¹¶ä½¿å…¶æˆä¸ºæ­¥éª¤ä¸€ä¸­åˆ›å»ºçš„æ ¹çš„å³å­©å­
> 5. å…ˆåºè¾“å‡ºè¿™æ£µæ ‘
> 
> åœ¨è¿›è¡Œé€’å½’ä¹‹å‰ï¼Œå› ä¸ºé“¾è¡¨ä¸æ”¯æŒéšæœºè®¿é—®ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠå®ƒçš„å€¼æŒ‰é¡ºåºæ‹¿å‡ºæ¥æ”¾å…¥ä¸€ä¸ªå…è®¸éšæœºè®¿é—®çš„æœ‰åºæ•°ç»„ä¸­
> 
> ç„¶åå¼€å§‹é€’å½’ï¼Œä»¥Example 1ä¸ºä¾‹ï¼Œè¿™ä¸ªæ•°ç»„çš„ä¸­é—´å…ƒç´ æ˜¯0ï¼Œé‚£ä¹ˆ0å°±æ˜¯è¿™æ£µæ ‘çš„æ ¹ç»“ç‚¹ã€‚å¦‚æœæ•°ç»„æ€»å…±æœ‰å››ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆæˆ‘ä»¬é€‰æ‹©ç¬¬ä¸‰ä¸ªå…ƒç´ ä½œä¸ºæ ‘çš„æ ¹ç»“ç‚¹ï¼ˆindex=size/2ï¼Œé™¤æ³•é»˜è®¤èˆå°¾ï¼‰
> 
> 0çš„å·¦åŠè¾¹ä¸º\[-10,-3\]ï¼Œä¸­é—´å…ƒç´ ä¸º-3ï¼Œå°†å…¶ä½œä¸º0å·¦å­æ ‘çš„æ ¹ç»“ç‚¹ï¼›-3çš„å·¦åŠè¾¹ä¸º\[-10\]ï¼Œåªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œ-10çš„å·¦å³åŠè¾¹çš†ä¸ºç©ºï¼Œå°†å…¶çœ‹æˆä¸­é—´å…ƒç´ ï¼Œä½œä¸º-3å·¦å­æ ‘çš„æ ¹ç»“ç‚¹ï¼Œè¿”å›æ ¹ç»“ç‚¹-10ï¼›-3çš„å³åŠè¾¹ä¸ºç©ºï¼Œè¿”å›æ ¹ç»“ç‚¹-3
> 
> 0çš„å³åŠè¾¹ä¸º\[5,9\]ï¼Œä¸­é—´å…ƒç´ ä¸º9ï¼Œå°†å…¶ä½œä¸º0å³å­æ ‘çš„æ ¹ç»“ç‚¹ï¼›9çš„å·¦åŠè¾¹ä¸º\[5\]ï¼Œåªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œ5çš„å·¦å³åŠè¾¹çš†ä¸ºç©ºï¼Œå°†å…¶çœ‹æˆä¸­é—´å…ƒç´ ï¼Œæˆä¸º9å·¦å­©å­çš„æ ¹ç»“ç‚¹ï¼Œè¿”å›æ ¹ç»“ç‚¹5ï¼›9çš„å³åŠè¾¹ä¸ºç©ºï¼Œè¿”å›æ ¹ç»“ç‚¹9
> 
> æœ€åè¿”å›æ ¹ç»“ç‚¹0ï¼Œè‡³æ­¤äºŒå‰æœç´¢æ ‘å°±å»ºå¥½äº†

ä¸Šé¢è¿™å¨æ˜¯æˆ‘è®©ç¨‹æµ©ç„¶å†™çš„ï¼Œæˆ‘è¿˜æ˜¯è‡ªå·±æ€»ç»“ä¸€éå§ã€‚é¦–å…ˆï¼Œæˆ‘è‡ªå·±æ²¡æƒ³å‡ºæ¥æ¯”è¾ƒå¥½çš„åšæ³•ï¼Œç„äº†ä¸€çœ¼ä¹‹å‰çš„ä»£ç ï¼Œæ€»ç»“å‡ºè¿™ä¸ªç®€å•çš„æ€è·¯ï¼š

1. è¿™ä¸ªé“¾è¡¨çš„ä¸­é—´å…ƒç´ å°±æ˜¯æœ€ç»ˆçš„æ ¹èŠ‚ç‚¹ï¼›
2. æ‰¾åˆ°é“¾è¡¨çš„å·¦åŠéƒ¨åˆ†å’Œå³åŠéƒ¨åˆ†ï¼Œå¯¹ä¸¤åŠé€’å½’åœ°åšè¿™ä¸ªæ“ä½œã€‚

è¿™æ ·å¾ˆç®€å•ï¼Œä¸æ–­å–ä¸­é—´å…ƒç´ ï¼Œæœ€åæ‹¼åˆ°ä¸€èµ·å°±è¡Œäº†ã€‚æ ¸å¿ƒä»£ç ï¼š

```cpp
curr->left = cutRecursively(nums, low, mid - 1);  
curr->right = cutRecursively(nums, mid + 1, high);
```

è¿™ä¸ªæ–¹æ³•éœ€è¦æ³¨æ„çš„ç‚¹ï¼š

1. è¿™æ˜¯é“¾è¡¨ï¼Œæ‰€ä»¥å¾—å…ˆè½¬åˆ°ä¸€ä¸ªæ•°ç»„é‡Œæ‰èƒ½å–lowå’Œhighï¼›
2. æ³¨æ„è¾¹ç•Œæƒ…å†µï¼Œå°¤å…¶æ˜¯low > highçš„æ—¶å€™ã€‚

ä»£ç ï¼š

```cpp
static TreeNode *cutRecursively(const vector<int> &nums, int low, int high) {
    if (low == high) {
        return new TreeNode(nums[low]);
    }
    if (low > high) {
	    // å¦‚æœé€’å½’çš„æ—¶å€™ï¼Œlow = 0ï¼Œmid = 0ï¼Œ
	    // ä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚é‚£ä¹ˆä¸‹ä¸€æ¬¡é€’å½’
	    // low = 0, high = -1ã€‚å°±ç›´æ¥è¿”å›ç©ºã€‚
	    // å¯ä»¥ç”¨[-10, -3, 0, 5, 9]è¿™ä¸ªä¾‹å­éªŒè¯ã€‚
        return nullptr;
    }
    int mid = (low + high) / 2;
    auto *curr = new TreeNode(nums[mid]);
    curr->left = cutRecursively(nums, low, mid - 1);
    curr->right = cutRecursively(nums, mid + 1, high);
    return curr;
}

TreeNode *Solution::sortedListToBST(ListNode *head) {
    if (head == nullptr) {
        return nullptr;
    }
    const auto *curr = head;
    vector<int> nums;
    while (curr) {
        nums.push_back(curr->val);
        curr = curr->next;
    }
    return cutRecursively(nums, 0, nums.size() - 1);
}
```

ç„¶åï¼Œæˆ‘çœ‹äº†ä¸€çœ¼é¢˜è§£ã€‚ç¬¬ä¸€ä¸ªæ–¹æ³•å’Œæˆ‘è¿™ä¸ªæ€è·¯æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œåªæ˜¯ç”¨äº†ä¸€ç§æ›´å¿«çš„æ–¹æ³•æ‰¾ä¸­é—´å€¼ã€‚è¿™ä¸ªä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯æˆ‘é¢è”šæ¥å®ä¹ çš„æ—¶å€™ç‘ç‘é—®è¿‡æˆ‘çš„ï¼Œæ‰¾é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹çš„æ–¹æ³•ï¼Œç”¨å¿«æ…¢æŒ‡é’ˆã€‚

ä½†æ˜¯ï¼Œè¿™æ ·åšçš„è¯ï¼Œæˆ‘ä»¬å°±ä¸èƒ½æ‹¿åˆ°lowå’Œhighè¿™æ ·çš„ä¿¡æ¯äº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦æ¢ä¸€ä¸ªæ€è·¯æ¥æƒ³è¿™ä¸ªé—®é¢˜ã€‚

é¦–å…ˆï¼Œç¬¬ä¸€æ¬¡æ‰¾çš„è¯ï¼Œæˆ‘ä»¬æ˜¯èƒ½çŸ¥é“midåœ¨å“ªé‡Œçš„ï¼Œåªéœ€è¦è¿™æ ·çš„ä»£ç ï¼š

```cpp
static ListNode *getMedian(ListNode *head) {
    ListNode *fast = head;
    ListNode *slow = head;
    while (fast != nullptr && fast->next != nullptr) {
        fast = fast->next->next;
        slow = slow->next;
    }
    return slow;
}
```

é‚£è¿™æ¬¡æ‰¾ä¹‹åï¼Œæˆ‘ä»¬å°±æœ‰äº†head, midè¿™ä¸¤ä¸ªèŠ‚ç‚¹ä¿¡æ¯äº†ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾å‡ºmidï¼Œå¹¶åˆ†æˆå·¦å³ä¸¤ä¸ªéƒ¨åˆ†ã€‚ä¹Ÿå°±æ˜¯$[0, mid)$å’Œ$[mid + 1, nullptr)$ã€‚æ³¨æ„è¿™ä¸¤ä¸ªé›†åˆä¸åŒ…å«midã€‚

é‚£ä¹ˆï¼Œå¦‚æœæƒ³è®¾è®¡æˆé€’å½’çš„å½¢å¼ï¼Œå‡½æ•°å‚æ•°çš„è®¾è®¡å°±æ˜¯å¾ˆé‡è¦çš„ã€‚åº”è¯¥æ€ä¹ˆè®¾è®¡å‘¢ï¼Ÿå‡è®¾ç°åœ¨æˆ‘ä»¬å¯¹å·¦åŠéƒ¨åˆ†é€’å½’ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ä¾ç„¶éœ€è¦è°ƒç”¨getMedianå‡½æ•°ã€‚ä½†æ˜¯ï¼Œæˆ‘å°±ä¸èƒ½åªä¼ ä¸€ä¸ªheadäº†ï¼Œå› ä¸ºåªæœ‰å¤´ä¿¡æ¯çš„è¯ï¼Œæ‰¾åˆ°çš„è¿˜æ˜¯æ•´ä¸ªé“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹ã€‚**æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ—¶æœºè®©å¿«æŒ‡é’ˆåœæ­¢ç§»åŠ¨**ã€‚

æ˜¾ç„¶ï¼Œè¿™ä¸ªæ—¶æœºå°±åœ¨äºwhileå¾ªç¯åº”è¯¥æ€ä¹ˆå†™ã€‚å¦‚æœå†™nullptrï¼Œé‚£å°±æ˜¯ä¸ä¸ºç©ºä¸åœæ­¢ã€‚å› æ­¤ï¼Œå¦‚æœå¸Œæœ›éå†åˆ°æ‰€æœ‰å±äº$[0, mid)$çš„å…ƒç´ ï¼Œ**å°±åº”è¯¥åœ¨fastæŒ‡å‘mid - 1çš„æ—¶å€™å°±åœæ­¢**ã€‚æ­¤æ—¶ï¼Œ`fast->next == mid`æˆç«‹ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æŠŠgetMedianæ”¹æˆè¿™æ ·ï¼š

```cpp
static ListNode *getMedian(ListNode *low, ListNode *high) {
    ListNode *fast = low;
    ListNode *slow = low;
    while (fast != high && fast->next != high) {
        fast = fast->next->next;
        slow = slow->next;
    }
    return slow;
}
```

è¿™æ ·ï¼Œæˆ‘ä»¬ä¼ `(head, nullptr)`ï¼Œå°±æ˜¯æ‰¾æ•´ä¸ªé“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹ï¼›åœ¨ç¬¬ä¸€æ¬¡å·¦åŠé€’å½’ä¸­ï¼Œä¼ `(head, mid)`ï¼Œå°±æ˜¯æ‰¾$[0, mid)$çš„ä¸­é—´èŠ‚ç‚¹ã€‚

è¿™ä¸ªæœ€å€¼å¾—æ€è€ƒçš„é—®é¢˜è¯´é€šï¼Œå‰©ä¸‹çš„å°±è¿åˆƒè€Œè§£äº†ã€‚ç›´æ¥ç»™ä»£ç ï¼š

```cpp
static ListNode *getMedian(ListNode *low, ListNode *high) {
    ListNode *fast = low;
    ListNode *slow = low;
    while (fast != high && fast->next != high) {
        fast = fast->next->next;
        slow = slow->next;
    }
    return slow;
}

static TreeNode *cutRecursive2(ListNode *low, ListNode *high) {
    if (low == high) {
        return nullptr;
    }
    ListNode *mid = getMedian(low, high);
    TreeNode *root = new TreeNode(mid->val);
    root->left = cutRecursive2(low, mid);
    root->right = cutRecursive2(mid->next, high);
    return root;
}

TreeNode *Solution::sortedListToBST2(ListNode *head) {
    if (head == nullptr) {
        return nullptr;
    }
    return cutRecursive2(head, nullptr);
}
```

> [!question] ä¸ºå•¥æˆ‘æ„Ÿè§‰æˆ‘è‡ªå·±å†™çš„æ–¹æ³•åè€Œå¿«ä¸€ç‚¹ï¼Ÿ
> - [ ] #TODO tasktodo1735576813999 ä»–è¿™ä¸ªæ–¹æ³•æ¯æ¬¡é€’å½’çš„æ—¶å€™éƒ½è¦å¿«æ…¢æŒ‡é’ˆæ‰«ä¸€éï¼Œæˆ‘è‡ªå·±çš„æ–¹æ³•å°±æ˜¯ä¸€å¼€å§‹å»ºä¸€ä¸ªæ•°ç»„ï¼Œåªéå†ä¸€æ¬¡ï¼Œå‰©ä¸‹çš„éƒ½æ˜¯ç›´æ¥è®¡ç®—å°±è¡Œã€‚ä¸ºå•¥æœ€åä»–çš„æ–¹æ³•åè€Œæ›´å¿«ï¼Ÿéš¾é“æ˜¯vectoræ„å»ºçš„è€—æ—¶å—ï¼Ÿâ• 2024-12-31 ğŸ”½ ğŸ†” f2f811 

- [ ] #TODO tasktodo1735576910421 åé¢è¿˜æœ‰ä¸€ä¸ªç»“åˆä¸­åºéå†çš„ä¼˜åŒ–æ€è·¯ã€‚æœ‰æ—¶é—´çœ‹çœ‹ã€‚ â• 2024-12-31 ğŸ”½ ğŸ†” iv0zzd 